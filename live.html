<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="robots" content="noindex,nofollow">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live Player</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/clappr/latest/clappr.css">
    <script src="https://cdn.jsdelivr.net/clappr/latest/clappr.min.js"></script>
</head>
<body>
    <div id="live-player"></div>

    <script>
        window.onload = function() {
            fetch('channels.json')
            .then(response => {
                if (!response.ok) {
                    throw new Error('Failed to fetch channels.json');
                }
                return response.json();
            })
            .then(channels => {
                if (!channels || channels.length === 0) {
                    console.error('No channels found in the JSON data.');
                    return;
                }

                channels.forEach(channel => {
                    fetch(channel.link, {
                        headers: {
                            'Cookie': channel.cookie
                        }
                    })
                    .then(response => {
                        if (!response.ok) {
                            throw new Error(`Failed to fetch m3u8 for ${channel.name}`);
                        }
                        return response.text();
                    })
                    .then(m3u8 => {
                        var player = new Clappr.Player({
                            source: m3u8,
                            parentId: '#live-player',
                            width: '100%',
                            height: '100%',
                            autoPlay: true,
                            watermark: {
                                image: channel.logo,
                                position: 'top-right'
                            }
                        });
                    })
                    .catch(error => console.error('Error:', error));
                });
            })
            .catch(error => console.error('Error fetching channels:', error));
        }
    </script>
</body>
</html>
